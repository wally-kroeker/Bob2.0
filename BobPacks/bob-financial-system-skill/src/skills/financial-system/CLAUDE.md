# Financial System - Comprehensive Methodology

## Mission & Philosophy

**Why This System Exists:**
Wally's financial sovereignty isn't about winning at capitalism — it's about escaping the system's grip so he can build parallel cooperative alternatives (StillPoint, FabLab, mutual aid networks). This system removes financial chaos and provides clear visibility into runway, enabling strategic decisions.

**Core Philosophy: Zero-Based Budgeting + Envelope Funds + Mission Alignment**

1. **Zero-Based:** Every dollar has a job before spending
2. **Envelope Funds:** Sinking funds for irregular expenses (car maintenance, annual subscriptions)
3. **Mission-Aligned:** Spending decisions reference parallel society values
4. **Data-Driven:** Historical patterns inform forecasting

---

## Entity Separation Model

### Three Distinct Financial Entities

#### Personal (Household)
**Purpose:** Financial sovereignty, emergency fund, stress reduction
**Post-tax thinking:** These are personal expenses from after-tax income
**Budget Categories:**
- Housing (rent/mortgage, utilities, internet)
- Groceries
- Personal subscriptions (entertainment, fitness, etc.)
- Transportation (car payment, insurance, gas, maintenance)
- Entertainment
- Emergency fund (6-month target)

**Mission Alignment:** Build runway so financial stress doesn't block spiritual clarity. Rest is a human birthright.

#### GoodFields (Corporate)
**Purpose:** Business income/expenses, tax optimization, consulting delivery
**Pre-tax thinking:** Business operates before personal taxes
**Budget Categories:**
- Software/SaaS (ChatGPT, GitHub, dev tools)
- Hardware (computers, networking equipment)
- Professional development (conferences, courses)
- Marketing
- Professional liability insurance
- Accounting/legal services

**Tax Strategy:** Maximize write-offs. Stan's advice: "Everything runs through the company."
- AI subscriptions used for consulting → business expense
- Home office percentage → business deduction
- Vehicle for business mileage → business expense
- Conference attendance → professional development

#### FabLab (Cooperative Infrastructure)
**Purpose:** Parallel society infrastructure, community capability building, AI-enabled sustainability
**Non-profit thinking:** Mission-driven spending aligned with community values
**Budget Categories:**
- Equipment (servers, networking, tools)
- Infrastructure maintenance (electricity, cooling)
- Community project funding
- Documentation & knowledge transfer
- Equipment replacement / depreciation

**Mission Alignment:** Build the technological foundation for places where people can thrive without extractive systems. Every equipment purchase enables someone else to build.

### Cross-Entity Intelligence
**Where They Intersect:**
- GoodFields revenue funds FabLab infrastructure
- GoodFields savings enable personal emergency fund growth
- FabLab infrastructure becomes proof-of-expertise for GoodFields consulting
- Tax optimization affects all three entities

---

## Budget System Design

### Zero-Based Budgeting Framework

**Principle:** Every dollar allocated before spending. No "leftover" money without a purpose.

**Monthly Budget Structure:**

```
# [Entity] Budget - November 2025

## Income
[Entity-specific revenue or allocation]

## Fixed Expenses
Predictable monthly costs (rent, utilities, subscriptions)

## Variable Expenses
Discretionary spending (groceries, gas, dining)

## Envelope Funds (Sinking Funds)
Allocations toward irregular future expenses

## Summary
- Total Allocated: $X
- Total Spent: $Y
- Variance: $Z (if positive, underspent; if negative, overspent)
- Runway: X months at current burn rate
```

### Envelope Budgeting

**Why Envelopes Matter:**
- Car maintenance happens unpredictably ($500 bill shocks the budget)
- Annual subscriptions create irregular cash flow needs
- Equipment replacements require advance planning

**Envelope Examples:**

**Personal Envelopes:**
- Car Maintenance ($200/month sinking fund → $2,400/year car fund)
- Emergency Fund ($500/month → 6 months expenses)
- Annual Subscriptions ($50/month → domain renewals, etc.)

**GoodFields Envelopes:**
- Equipment Replacement ($100/month → server upgrades, network gear)
- Tax Reserve ($400/month → quarterly tax payments, accountant fees)
- Professional Liability Insurance ($50/month → annual premium)

**FabLab Envelopes:**
- Equipment Lifecycle ($200/month → planned equipment replacements)
- Infrastructure Upgrades ($100/month → network improvements)
- Community Project Funding ($300/month → equipment for members)

---

## Expense Categorization

### Personal Expenses (Post-tax)
**These come from personal income after taxes**
- Groceries, dining out, entertainment
- Housing costs not in business
- Personal subscriptions
- Personal transportation
- Clothing, household items
- Healthcare, fitness
- Kids activities, education

### Business Expenses (Pre-tax)
**These reduce corporate taxable income (GoodFields)**
- AI tools used for consulting (ChatGPT, Claude Pro)
- Development tools (GitHub, Copilot, IDEs)
- Professional services (accounting, legal, consulting)
- Business insurance
- Office equipment
- Conference attendance
- Advertising/marketing
- Home office (percentage-based)
- Vehicle (business mileage)

### Shared/Mixed Expenses
**Allocate based on business use percentage**
- Home Internet: 70% business (consulting/development), 30% personal
- Cell Phone: 60% business (client calls), 40% personal
- Vehicle: Track business mileage separately
- Home Office: Calculate square footage percentage

### FabLab Expenses
**Non-profit/cooperative infrastructure**
- Equipment purchases (servers, switches, UPS)
- Network costs (electricity for lab, cooling)
- Documentation (time, tools, hosting)
- Community training (materials, equipment)
- Grant applications (if applicable)

---

## Cash Flow Forecasting

### Runway Calculation
**Runway = Emergency Fund / Monthly Burn Rate**

Example:
- Personal emergency fund: $15,000
- Monthly personal expenses: $4,000
- Runway: 3.75 months (114 days until emergency fund depleted)

**Strategic Use:**
- If Hydro contract lands ($9,600/month) → 24+ months personal runway
- If no business revenue → need alternative income within 3 months
- FabLab funded from GoodFields surplus → no separate runway threat

### Burn Rate Analysis
**Three Burn Rates to Track:**
1. Personal burn (household expenses)
2. GoodFields burn (business expenses without revenue)
3. Combined burn (all entities without outside revenue)

**Urgency Signals:**
- Personal runway < 2 months → activation (R1 equivalent)
- GoodFields revenue < 50% of burn → pivot needed
- FabLab funded, not competing → lower priority

### Scenario Modeling
**"What-If" Questions Bob Can Answer:**
- "What if Manitoba Hydro contract closes? New runway?"
- "Can we fund FabLab at current burn rate?"
- "What if subscriptions migrate to GoodFields? Tax savings impact?"
- "How long until emergency fund target reached?"

---

## Tax Optimization Strategy

### Personal vs. Corporate Allocation

**Decision Framework (CRA Compliance):**
- If used primarily for business → GoodFields
- If used primarily for personal → Personal
- If mixed → Allocate based on percentage use (document it)

**Examples:**
- ChatGPT Plus ($20/month) → 100% GoodFields (consulting research, AI expertise development)
- Netflix ($15/month) → 100% Personal (relaxation, not business)
- Home Internet ($80/month) → 60% GoodFields / 40% Personal (work-from-home proportion)

### Write-Off Tracking

**Required Documentation:**
- Receipt (digital or physical)
- Date of expense
- Business purpose (for any business expense)
- Payment method (card/check)
- Category (for proper income statement)

**Categories for CRA:**
- Office Equipment (depreciated)
- Office Supplies (expensed same year)
- Professional Services (accounting, legal)
- Tools & Equipment (depreciated)
- Meals & Entertainment (50% deductible, meal only)
- Vehicle & Travel (mileage log required)
- Home Office (square footage calculation)

### Quarterly Tax Planning
**Recommended Process:**
1. Export financial data for quarter
2. Categorize business vs. personal
3. Identify write-off opportunities
4. Estimate quarterly tax payment needed
5. Review with accountant (once hired)

---

## Asset & Maintenance Tracking

### Asset Registry Purpose
Long-term tracking of:
- Purchase date & cost
- Current value (depreciation)
- Maintenance history
- Expected replacement cycle
- CRA depreciation schedules (for business assets)

### Vehicle Tracking (Personal Example)
```
Vehicle: 2018 Honda Civic
Purchase: 2018-06-15, $18,000
Current Value: ~$12,000
Maintenance Schedule:
  - Oil change: Every 5,000 km
  - Tire rotation: Every 10,000 km
  - Winter tire swap: Nov/Apr
  - Brake inspection: Annual
Cost History: [logged entries]
```

### Equipment Tracking (FabLab Example)
```
Proxmox Server #1
Purchase: 2023-03-20, $1,200
Depreciation: 20% per year (3-year useful life)
Current Depreciated Value: $720
Replacement Cycle: 5-7 years
Last Service: 2025-11-15 (cooling, firmware update)
Next Scheduled: 2025-12-15
Mission Value: Core infrastructure for sovereign tech stack
```

---

## Integration with Telos Skill

### Data Flow
**Telos → Financial-System:**
- Revenue pipeline projections (GoodFields income forecast)
- R1 urgency (severance runway deadline)
- FabLab goals (infrastructure investment priority)

**Financial-System → Telos:**
- Runway calculations (updates R1 risk)
- Budget constraints (inform goal prioritization)
- Cash flow alerts (adjust timelines)
- Tax optimization findings (strategy updates)

### Cross-Skill Queries
**Example:** "Bob, business partner mode"
1. Telos activates → shows G1/R1 status
2. Bob mentions R1 urgency → asks if you want financial runway check
3. Financial-system activates → calculates combined runway
4. Bob: "R1 critical, personal runway 4.2 months, GoodFields runway 2.1 months. Manitoba Hydro contract essential."

---

## Integration with Publishing Loop

### Financial Milestones
**When to Document:**
- Budget system implementation → `feat(project/bob): financial tracking skill !milestone`
- Major optimization wins → Build-log entry
- Infrastructure purchases → FabLab project milestone

**Privacy Note:** Publishing loop commits are PUBLIC — never include actual financial data, only system/methodology improvements.

---

## Privacy & Security

### Data Protection Strategy

**Public (Git-Tracked):**
- SKILL.md (this file)
- CLAUDE.md (methodology)
- scripts/ (analysis code)
- templates/ (budget templates)

**Private (Gitignored):**
- data/ directory (ALL actual financial data)
  - accounts.md (account list with last 4 digits only)
  - personal-finances.md (spending, budget, amounts)
  - goodfields-finances.md (business income/expenses)
  - fablab-finances.md (infrastructure costs)
  - subscriptions.md (recurring charges, costs)
  - cross-entity/ (transfers, forecasts, amounts)

### File Permissions
```bash
chmod 600 data/*/*.md  # Owner-only read/write
```

### Bob's Privacy Handling
- Summarizes trends, never quotes amounts in conversation
- Provides percentages and relative comparisons
- Example: "You're 12% over budget" not "$340 over budget"
- References "envelope fund for car maintenance" not specific dollar amounts

### Backup Strategy
- Local encrypted backup to external drive (weekly)
- Optional cloud backup via encrypted GPG (not recommended for sensitive data)
- Keep private encrypted copy separate from public repo

---

## Mission Alignment Framework

### How Financial Decisions Support the Larger Mission

**Decision Filter for Any Financial Choice:**

1. **Does this move me toward financial sovereignty?**
   - Reduces dependency on extractive systems ✓
   - Decreases debt/vulnerability ✓

2. **Does this fund parallel society infrastructure?**
   - Supports FabLab, StillPoint, cooperative building ✓
   - Enables other people's freedom ✓

3. **Is this aligned with values?**
   - Privacy-respecting ✓
   - Community-building ✓
   - Not extractive ✓

4. **Is this sustainable long-term?**
   - Can maintain it without burnout ✓
   - Creates positive compounding ✓

### Financial Sovereignty = Freedom to Build Alternatives

Financial independence isn't the goal. **Freedom to prototype cooperative alternatives** is the goal.

When you have:
- No survival stress
- Predictable food/shelter
- Time for rest
- Clear financial visibility

Then you can:
- Design better systems
- Help build communities
- Demonstrate that alternatives work
- Free others from extractive cycles

---

## Workflow & Update Cadence

### Daily
- Track spending (automatic from bank)
- Check major purchases against envelope funds

### Weekly
- Review subscriptions (any new charges?)
- Monitor cash flow (still on track?)

### Monthly
- Budget variance analysis (planned vs. actual)
- Envelope fund review (all on track?)
- Tax categorization (if business revenue occurred)

### Quarterly
- Tax planning (quarterly payment, write-off optimization)
- Asset maintenance review (any major expenses coming?)
- Scenario modeling (do projections still hold?)

### Annually
- Full year review
- Tax filing preparation
- Budget targets for next year
- Long-term runway planning

---

## Success Criteria

### Phase 1 (Foundation)
- ✓ Budget system implemented
- ✓ Spending categorized
- ✓ Envelope funds established
- ✓ Emergency fund target visible

### Phase 2 (Optimization)
- ✓ Tax write-offs identified and tracked
- ✓ Subscription migrations executed
- ✓ Monthly reviews automated
- ✓ Runway forecasting working

### Phase 3 (Strategic)
- ✓ Cross-entity decisions data-driven
- ✓ Financial stress reduced
- ✓ Clarity enabling strategic focus
- ✓ Surplus capacity for FabLab funding

### Long-Term (Mission)
- Financial sovereignty achieved
- Parallel society infrastructure funded
- Others using this framework
- StillPoint prototype feasible

---

## Firefly III Integration

### Architecture

**Firefly III** (deployed at 10.10.10.34:8080) serves as the primary source of truth for all financial data.

**Three Asset Accounts** in single Firefly instance:
- Personal Checking - household finances
- GoodFields Business - corporate consulting
- FabLab Operations - cooperative infrastructure

**Data Flow**:
```
Transactions Entered in Firefly III Web UI
         ↓
Firefly REST API (10.10.10.34:8080/api/v1)
         ↓
firefly_sync.py Script
         ↓
Markdown Cache (personal/, goodfields/, fablab/)
         ↓
Bob Analysis (hybrid: markdown + live queries)
```

### Three-Phase Integration Plan

#### Phase 1: Manual Entry + Bob Reminders (Current)
**Status**: Foundation setup

**Workflow**:
1. User enters transactions in Firefly web UI
2. User tells Bob: "Update Firefly"
3. Bob runs sync script to cache current month to markdown
4. Bob provides analysis against cached + live data

**Setup Tasks**:
- [ ] Create three asset accounts (Personal/GoodFields/FabLab)
- [ ] Configure expense categories aligned with financial-system
- [ ] Set up budgets (zero-based + envelope funds)
- [ ] Configure transaction tags (entity/purpose)
- [ ] Test sync script and API access

**Bob Capabilities**:
- Budget variance analysis (planned vs. actual)
- Spending pattern recognition
- Runway calculations
- Tax deduction identification
- Cross-entity insights

#### Phase 2: Bank Import Automation (Next Phase)
**Target**: When manual workflow becomes routine

**Workflow**:
1. User connects bank via Data Importer (10.10.10.34:8081)
2. Transactions auto-import from bank
3. Categorization rules apply automatically
4. Weekly sync to markdown cache
5. Bob proactively alerts on budget variances

**Implementation**:
- Configure CSV import rules in Data Importer
- Create N8N workflow for weekly sync
- Add budget variance alerts to Vikunja
- Aggregate entities into weekly report

#### Phase 3: Full N8N Automation (Q1 2026)
**Target**: Mature automation framework

**Workflow**:
1. Bank transactions auto-import 24/7
2. Categorization and entity allocation automatic
3. Daily markdown cache updates
4. Scheduled reports (weekly/monthly)
5. Proactive alerts (over-budget, tax deadlines, runway warnings)

**Features**:
- N8N SOAR automation
- Scheduled emails/Vikunja tasks
- Trend analysis and forecasting
- Tax optimization recommendations
- Cross-entity funding decisions

### Hybrid Data Access Pattern

Bob uses two data sources for analysis:

**Historical Data (Markdown Cache)**:
- Fast responses (no API calls)
- Works offline
- Good for trends and patterns
- Contains past month data

**Current Month (Live API Query)**:
- Real-time accuracy
- Latest transactions
- Budget variance this month
- Recent spending spikes

**Example Query**:
```
User: "What's my budget variance this month?"

Bob:
1. Reads markdown cache (all past months)
2. Queries Firefly API (current month transactions)
3. Compares actual vs. budgeted
4. Analyzes historical patterns
5. Returns: "Personal: +$140 over (dining 12% up),
            GoodFields: -$800 under (no new client revenue),
            Combined runway: 4.2 months at current burn"
```

### Sync Script Architecture

**Location**: `scripts/firefly_sync.py`

**What it does**:
1. Authenticates to Firefly API (Bearer token)
2. Fetches current month transactions
3. Organizes by entity (account)
4. Generates markdown per account
5. Updates cache files (personal/, goodfields/, fablab/)

**What it exports**:
- Transaction list with amounts, dates, categories
- Budget variance calculations
- Running balance per account
- Cross-entity transfer tracking

**Schedule**:
- Phase 1: Manual via Bob command
- Phase 2: Weekly via cron/N8N
- Phase 3: Daily via N8N workflow

### Firefly API Integration

**Endpoint**: `http://10.10.10.34:8080/api/v1`

**Authentication**: Bearer token (Personal Access Token from Firefly UI)

**Key Endpoints**:
- `GET /accounts` - List all accounts
- `GET /accounts/{id}/transactions` - Get transactions for account
- `GET /budgets` - List budgets and status
- `GET /transaction-journals` - All transactions (cross-account)
- `POST /transactions` - Create transaction (future automation)

**Rate Limiting**: None (internal API)

**Data Privacy**: All queries remain on local network (10.10.10.34)

### Markdown Cache Format

**File Structure**:
```
data/personal/
  ├── 2025-11-transactions.md
  ├── 2025-10-transactions.md
  └── monthly-summary.md

data/goodfields/
  ├── 2025-11-transactions.md
  └── monthly-summary.md

data/fablab/
  ├── 2025-11-transactions.md
  └── monthly-summary.md
```

**Cache File Example**:
```markdown
# Personal Finances - November 2025

## Summary
- Account Balance: $4,250
- Transactions: 28
- Total Spent: $3,840
- Budget Status: +$160 under

## Transactions
| Date | Category | Amount | Description |
|------|----------|--------|-------------|
| 2025-11-15 | Groceries | $85 | Safeway |
| 2025-11-14 | Gas | $45 | Shell |
| 2025-11-13 | Utilities | $120 | Hydro |

## Budget Variance
| Category | Budget | Actual | Variance |
|----------|--------|--------|----------|
| Housing | $1200 | $1200 | 0% |
| Groceries | $400 | $340 | -15% |
| Dining | $150 | $200 | +33% |
```

### Updates to Financial-System Integration

**When Bob Activates**:
1. Load financial-system skill
2. Check if Firefly data cached locally
3. Query Firefly API for current month (if needed)
4. Perform analysis
5. Present results with confidence (live data vs. cached)

**Example Session**:
```
You: "What's my financial health?"
Bob: [Financial-system activated]
Bob: "Loading Firefly data...
- Personal: 4.2 months runway ← Firefly API
- GoodFields: Waiting on Hydro contract ← Cached
- FabLab: Operations nominal ← Cached

Top concern: Personal runway < 6 months (R1 urgency)"
```

### Security Considerations

**Data Protection**:
- Firefly stored on internal LAN only (10.10.10.34)
- API token in `.env.importer` (not committed to git)
- Markdown cache in gitignored `data/` directory
- No financial data committed to public repos

**Bob's Privacy Handling**:
- Summarizes trends, never quotes raw amounts
- Uses percentages and relative comparisons
- References categories, not account numbers
- No financial data in conversation logs

### Future Enhancements

**Planned**:
- Tax write-off auto-detection
- Subscription optimizer (move to GoodFields where possible)
- Scenario modeling ("What if I get Hydro contract?")
- Receipt OCR for Data Importer
- Mobile app for on-the-go transaction entry

**Potential**:
- Machine learning spending pattern detection
- Anomaly alerts (unusual transactions)
- Budget goal achievement predictions
- Multi-currency support (if traveling)

---

## Technical Stack

**Languages:** Python 3, Markdown, SQL (Firefly database)
**Libraries:** pandas, python-dateutil, requests (Firefly API)
**Storage:** Markdown files (cache) + Firefly III database (source of truth)
**Scripts:** firefly_sync.py, budget analysis, tax categorization
**API**: Firefly III REST API (internal only)
**Output:** Markdown summaries + live API queries for Bob integration

---

**Last Updated:** 2025-11-17
**Next Review:** When Firefly Phase 1 setup complete
**Firefly Deployment Date:** 2025-11-17
